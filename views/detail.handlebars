<link rel="stylesheet" href="/css/detail.css" />

<section class="detail">

  <!-- Header -->
  <header class="detail-header">
    <h1 class="detail-title">{{recipe.title}}</h1>
    {{#if recipe.category}}
      <span class="detail-badge">Category: {{recipe.category}}</span>
    {{/if}}
  </header>

  <!-- Hero  -->
  <div class="detail-hero">
    <div class="image-frame">
      {{#if images.length}}
        <img
          class="detail-image"
          src="{{images.0.web}}?v={{cacheBuster}}"
          alt="{{recipe.title}}"
          loading="lazy"
        />
      {{else}}
        <div class="detail-image placeholder" aria-hidden="true">No image</div>
      {{/if}}
    </div>

    {{#if recipe.summary}}
      <p class="detail-summary">{{recipe.summary}}</p>
    {{/if}}
  </div>

  <!-- Upload / Delete -->

  {{#if session.isLoggedIn}}
    <!-- Upload / Replace Image -->
    <form
      action="/item/{{recipe.id}}/image"
      method="POST"
      enctype="multipart/form-data"
      style="margin:.75rem 0;"
    >
      <input type="file" name="image" accept="image/png, image/jpeg" required />
      <button type="submit">Upload / Replace Image</button>
    </form>

    {{#if images.length}}
      <form
        action="/item/{{recipe.id}}/image/delete"
        method="POST"
        style="margin:.25rem 0;"
      >
        <button type="submit">Delete Image</button>
      </form>
    {{/if}}
  {{/if}}

  <!-- Ingredients /Instructions -->
  <div class="detail.grid">
    <section class="detail.ingredients">
      <h2>Ingredients</h2>
      {{#if ingredients.length}}
        <ul class="ingredients.list">
          {{#each ingredients}}
            <li class="ingredients.item">
              {{#if this.amount}}
                <span class="ingredients.amount">{{this.amount}}</span>
              {{/if}}
              <span class="ingredients.name">{{this.name}}</span>
            </li>
          {{/each}}
        </ul>
      {{else}}
        <p class="muted">No ingredients listed yet.</p>
      {{/if}}
    </section>

    <section class="detail.instructions">
      <h2>Instructions</h2>
      {{#if instructionsLines}}
        <ol class="instructions.list">
          {{#each instructionsLines}}
            <li class="instructions.step">{{this}}</li>
          {{/each}}
        </ol>
      {{else if recipe.instructions}}
        <div class="instructions.block">
          {{{recipe.instructions}}}
        </div>
      {{else}}
        <p class="muted">No instructions provided yet.</p>
      {{/if}}
    </section>
  </div>
</section>